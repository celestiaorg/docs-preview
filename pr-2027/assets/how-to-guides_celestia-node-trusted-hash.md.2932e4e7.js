import{_ as s,o as a,c as o,Q as n}from"./chunks/framework.c26b34bb.js";const F=JSON.parse('{"title":"Syncing a light node from a trusted hash","description":"How to sync a light node from a trusted hash.","frontmatter":{"description":"How to sync a light node from a trusted hash.","head":[["meta",{"property":"og:title","content":"Syncing a light node from a trusted hash | Celestia Docs"}],["meta",{"property":"og:description","content":"How to sync a light node from a trusted hash."}]]},"headers":[],"relativePath":"how-to-guides/celestia-node-trusted-hash.md","filePath":"how-to-guides/celestia-node-trusted-hash.md","lastUpdated":1746450532000}'),l={name:"how-to-guides/celestia-node-trusted-hash.md"},e=n(`<h1 id="syncing-a-light-node-from-a-trusted-hash" tabindex="-1">Syncing a light node from a trusted hash <a class="header-anchor" href="#syncing-a-light-node-from-a-trusted-hash" aria-label="Permalink to &quot;Syncing a light node from a trusted hash&quot;">​</a></h1><p>This guide goes over how to sync a DA light node from a trusted hash. The example uses the Mocha testnet. You will need to adjust the commands accordingly for Mainnet Beta, Arabica, or a custom network.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Syncing to a trusted hash means that you will not sample the entire chain. This adds a trust assumption that you trust the history of the chain up to that point and that you trust the entity where you get the hash from. In this example, the trusted entity is a consensus endpoint or Celenium.</p></div><h2 id="general-approach" tabindex="-1">General Approach <a class="header-anchor" href="#general-approach" aria-label="Permalink to &quot;General Approach&quot;">​</a></h2><ol><li><p>Get trusted height &amp; hash from a consensus endpoint or <a href="https://celenium.io" target="_blank" rel="noreferrer">Celenium</a>.</p></li><li><p>Initialize the node store</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">celestia</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">light</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">init</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--p2p.network</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">networ</span><span style="color:#E1E4E8;">k</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">celestia</span><span style="color:#24292E;"> </span><span style="color:#032F62;">light</span><span style="color:#24292E;"> </span><span style="color:#032F62;">init</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--p2p.network</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">networ</span><span style="color:#24292E;">k</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div></li><li><p>Set the trusted height &amp; hash in your config file</p><ol><li>Open your <code>config.toml</code> at <code>.celestia-light/config.toml</code> (or <code>.celestia-light-&lt;other-network&gt;/config.toml</code>)</li><li>Set <code>DASer.SampleFrom</code> to the trusted height (e.g. <code>SampleFrom = 123456</code>)</li><li>Set <code>Header.TrustedHash</code> to the trusted hash (e.g. <code>TrustedHash = &quot;&lt;hash_of_block_n&gt;&quot;</code>)</li></ol></li><li><p>Run the node:</p></li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">celestia</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">light</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">start</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--p2p.network</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">networ</span><span style="color:#E1E4E8;">k</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--core.ip</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">consensus-node-rp</span><span style="color:#E1E4E8;">c</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--core.port</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">por</span><span style="color:#E1E4E8;">t</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">celestia</span><span style="color:#24292E;"> </span><span style="color:#032F62;">light</span><span style="color:#24292E;"> </span><span style="color:#032F62;">start</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--p2p.network</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">networ</span><span style="color:#24292E;">k</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--core.ip</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">consensus-node-rp</span><span style="color:#24292E;">c</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--core.port</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">por</span><span style="color:#24292E;">t</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h2 id="automated-approach" tabindex="-1">Automated Approach <a class="header-anchor" href="#automated-approach" aria-label="Permalink to &quot;Automated Approach&quot;">​</a></h2><p>You can automate the process of setting the trusted height and hash using the following commands for Mocha testnet:</p><h3 id="_1-initialize-the-node-store-if-not-already-done" tabindex="-1">1. Initialize the node store (if not already done) <a class="header-anchor" href="#_1-initialize-the-node-store-if-not-already-done" aria-label="Permalink to &quot;1. Initialize the node store (if not already done)&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">celestia</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">light</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">init</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--p2p.network</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mocha</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">celestia</span><span style="color:#24292E;"> </span><span style="color:#032F62;">light</span><span style="color:#24292E;"> </span><span style="color:#032F62;">init</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--p2p.network</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mocha</span></span></code></pre></div><h3 id="_2-get-and-set-the-trusted-height-and-hash-automatically" tabindex="-1">2. Get and set the trusted height and hash automatically <a class="header-anchor" href="#_2-get-and-set-the-trusted-height-and-hash-automatically" aria-label="Permalink to &quot;2. Get and set the trusted height and hash automatically&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># Get both the height and hash values</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> TRUSTED_HEIGHT</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">$(</span><span style="color:#B392F0;">curl</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-s</span><span style="color:#9ECBFF;"> &quot;https://rpc-mocha.pops.one/header&quot; </span><span style="color:#F97583;">|</span><span style="color:#9ECBFF;"> </span><span style="color:#B392F0;">jq</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#9ECBFF;"> &#39;.result.header.height&#39;)</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> TRUSTED_HASH</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">$(</span><span style="color:#B392F0;">curl</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-s</span><span style="color:#9ECBFF;"> &quot;https://rpc-mocha.pops.one/header&quot; </span><span style="color:#F97583;">|</span><span style="color:#9ECBFF;"> </span><span style="color:#B392F0;">jq</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#9ECBFF;"> &#39;.result.header.last_block_id.hash&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Use sed to find and replace the SampleFrom value in the config file (macOS version)</span></span>
<span class="line"><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;s/SampleFrom = .*/SampleFrom = </span><span style="color:#E1E4E8;">$TRUSTED_HEIGHT</span><span style="color:#9ECBFF;">/&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">~/.celestia-light-mocha-4/config.toml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Add/update the TrustedHash value</span></span>
<span class="line"><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;s/TrustedHash = .*/TrustedHash = </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#E1E4E8;">$TRUSTED_HASH</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">/&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">~/.celestia-light-mocha-4/config.toml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Display the updated values to confirm</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;SampleFrom updated to: </span><span style="color:#E1E4E8;">$TRUSTED_HEIGHT</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;TrustedHash updated to: </span><span style="color:#E1E4E8;">$TRUSTED_HASH</span><span style="color:#9ECBFF;">&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># Get both the height and hash values</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> TRUSTED_HEIGHT</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">$(</span><span style="color:#6F42C1;">curl</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-s</span><span style="color:#032F62;"> &quot;https://rpc-mocha.pops.one/header&quot; </span><span style="color:#D73A49;">|</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">jq</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-r</span><span style="color:#032F62;"> &#39;.result.header.height&#39;)</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> TRUSTED_HASH</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">$(</span><span style="color:#6F42C1;">curl</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-s</span><span style="color:#032F62;"> &quot;https://rpc-mocha.pops.one/header&quot; </span><span style="color:#D73A49;">|</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">jq</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-r</span><span style="color:#032F62;"> &#39;.result.header.last_block_id.hash&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Use sed to find and replace the SampleFrom value in the config file (macOS version)</span></span>
<span class="line"><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;s/SampleFrom = .*/SampleFrom = </span><span style="color:#24292E;">$TRUSTED_HEIGHT</span><span style="color:#032F62;">/&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">~/.celestia-light-mocha-4/config.toml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Add/update the TrustedHash value</span></span>
<span class="line"><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;s/TrustedHash = .*/TrustedHash = </span><span style="color:#005CC5;">\\&quot;</span><span style="color:#24292E;">$TRUSTED_HASH</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">/&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">~/.celestia-light-mocha-4/config.toml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Display the updated values to confirm</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;SampleFrom updated to: </span><span style="color:#24292E;">$TRUSTED_HEIGHT</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;TrustedHash updated to: </span><span style="color:#24292E;">$TRUSTED_HASH</span><span style="color:#032F62;">&quot;</span></span></code></pre></div><h3 id="_3-start-the-node" tabindex="-1">3. Start the node <a class="header-anchor" href="#_3-start-the-node" aria-label="Permalink to &quot;3. Start the node&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">celestia</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">light</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">start</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--p2p.network</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mocha</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--core.ip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rpc-mocha.pops.one</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--core.port</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">9090</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">celestia</span><span style="color:#24292E;"> </span><span style="color:#032F62;">light</span><span style="color:#24292E;"> </span><span style="color:#032F62;">start</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--p2p.network</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mocha</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--core.ip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rpc-mocha.pops.one</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--core.port</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">9090</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>For Linux users, remove the empty string (<code>&#39;&#39;</code>) after <code>-i</code> in the <code>sed</code> commands:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;s/SampleFrom = .*/SampleFrom = </span><span style="color:#E1E4E8;">$TRUSTED_HEIGHT</span><span style="color:#9ECBFF;">/&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">~/.celestia-light-mocha-4/config.toml</span></span>
<span class="line"><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;s/TrustedHash = .*/TrustedHash = </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#E1E4E8;">$TRUSTED_HASH</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">/&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">~/.celestia-light-mocha-4/config.toml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;s/SampleFrom = .*/SampleFrom = </span><span style="color:#24292E;">$TRUSTED_HEIGHT</span><span style="color:#032F62;">/&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">~/.celestia-light-mocha-4/config.toml</span></span>
<span class="line"><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;s/TrustedHash = .*/TrustedHash = </span><span style="color:#005CC5;">\\&quot;</span><span style="color:#24292E;">$TRUSTED_HASH</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">/&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">~/.celestia-light-mocha-4/config.toml</span></span></code></pre></div></div><h2 id="for-service-operators" tabindex="-1">For service operators <a class="header-anchor" href="#for-service-operators" aria-label="Permalink to &quot;For service operators&quot;">​</a></h2><p>If you&#39;re using multiple light nodes for similar services like tracking the same rollup, it is recommended to use the same hash and height for all services using the same starting height.</p>`,17),p=[e];function t(c,r,i,y,h,d){return a(),o("div",null,p)}const u=s(l,[["render",t]]);export{F as __pageData,u as default};
