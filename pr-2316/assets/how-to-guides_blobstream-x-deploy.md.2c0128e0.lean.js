import{_ as a,o as n,c as e,O as o}from"./chunks/framework.9880cf58.js";const E=JSON.parse('{"title":"New Blobstream X deployments","description":"","frontmatter":{"next":{"text":"Node API","link":"/tutorials/node-api"},"head":[["meta",{"property":"og:title","content":"New Blobstream X deployments | Celestia Docs"}],["meta",{"property":"og:description","content":"The first modular blockchain network."}]]},"headers":[],"relativePath":"how-to-guides/blobstream-x-deploy.md","filePath":"how-to-guides/blobstream-x-deploy.md","lastUpdated":1764015958000}'),l={name:"how-to-guides/blobstream-x-deploy.md"};function t(p,s,c,r,i,y){return n(),e("div",null,[...s[0]||(s[0]=[o(`<h1 id="new-blobstream-x-deployments" tabindex="-1">New Blobstream X deployments <a class="header-anchor" href="#new-blobstream-x-deployments" aria-label="Permalink to &quot;New Blobstream X deployments&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">DEPRECATED</p><p>BlobstreamX is the previous implementation of Blobstream. The <a href="https://github.com/succinctlabs/blobstreamx" target="_blank" rel="noreferrer">BlobstreamX repository</a> is now archived.</p><p>For new deployments, consider using <a href="/docs-preview/pr-2316/how-to-guides/sp1-blobstream-deploy">SP1 Blobstream</a> instead.</p></div><p>This document will go over the instructions to deploy BlobstreamX to a new chain.</p><h2 id="deploying-the-contracts" tabindex="-1">Deploying the contracts <a class="header-anchor" href="#deploying-the-contracts" aria-label="Permalink to &quot;Deploying the contracts&quot;">​</a></h2><p>To deploy a Blobstream X to a new chain, where a Gateway contract does not exist yet, the following steps need to be followed.</p><p>If any of the components already exist in the target chain, feel free to skip the corresponding step.</p><h3 id="deploy-a-new-succinctgateway" tabindex="-1">Deploy a new SuccinctGateway <a class="header-anchor" href="#deploy-a-new-succinctgateway" aria-label="Permalink to &quot;Deploy a new SuccinctGateway&quot;">​</a></h3><p>The <code>SuccinctGateway</code> is a contract that acts as a registry for onchain circuit verifiers and manages their access control. It is the entrypoint for proof verification and does the following:</p><ol><li>Receive a PLONK proof from the prover</li><li>Fetch the address of the target function verifier</li><li>Verify if the prover is whitelisted, if whitelisting is enabled</li><li>Forward the proof to the function verifier to be verified</li><li>If the proof is valid, it calls back the <code>BlobstreamX</code> contract to update its state</li></ol><p>The <code>BlobstreamX</code> requires the update to be provided through the <code>SuccinctGateway</code>. Otherwise, the contract can&#39;t be updated.</p><p>To deploy a <code>SuccinctGateway</code> contract, you need to have <code>foundry</code> installed. If not, refer to <a href="https://book.getfoundry.sh/getting-started/installation" target="_blank" rel="noreferrer">foundry documentation</a>.</p><p>Then, clone the succinctx repo:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clone</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/succinctlabs/succinctx</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">succinctx</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clone</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/succinctlabs/succinctx</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">succinctx</span></span></code></pre></div><p>Next, build the contracts:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">contracts</span></span>
<span class="line"><span style="color:#B392F0;">forge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">build</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">contracts</span></span>
<span class="line"><span style="color:#6F42C1;">forge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span></span></code></pre></div><p>Then, setup the <code>.env</code> containing the required information for deployment. An example <code>.env.example</code> is provided to be inspired from.</p><p>Assume we&#39;re deploying to a chain which chainID is 12345. The <code>.env</code> should look like:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># The salt to be used for CREATE2 deployments. It&#39;s a 32-byte string in hex format.</span></span>
<span class="line"><span style="color:#6A737D;"># Example: 0x0000000000000000000000000000000000000000000000000000000000000001</span></span>
<span class="line"><span style="color:#E1E4E8;">CREATE2_SALT</span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#6A737D;"># The &#39;owner&#39; of the contracts, recommended to be an EOA</span></span>
<span class="line"><span style="color:#E1E4E8;">GUARDIAN</span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#6A737D;"># The default prover to fulfill requests for Functions that have not opted for a different prover</span></span>
<span class="line"><span style="color:#E1E4E8;">PROVER</span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#6A737D;"># RPC URLs for each chain you want to deploy to</span></span>
<span class="line"><span style="color:#E1E4E8;">RPC_12345</span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#6A737D;"># Etherscan API keys for each chain you want to deploy to</span></span>
<span class="line"><span style="color:#E1E4E8;">ETHERSCAN_API_KEY_12345</span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#6A737D;"># Wallet type is the type of the wallet.</span></span>
<span class="line"><span style="color:#6A737D;"># If you are using a ledger to sign the transaction,</span></span>
<span class="line"><span style="color:#6A737D;"># set \`WALLET_TYPE=LEDGER\` and specify the \`MNEMONIC_INDEX\`</span></span>
<span class="line"><span style="color:#6A737D;"># for which signer you want to use.</span></span>
<span class="line"><span style="color:#6A737D;"># If you are using a private key,</span></span>
<span class="line"><span style="color:#6A737D;"># set \`WALLET_TYPE=PRIVATE_KEY\` and specify the \`PRIVATE_KEY\`.</span></span>
<span class="line"><span style="color:#6A737D;"># In this example, we&#39;re using private key.</span></span>
<span class="line"><span style="color:#E1E4E8;">WALLET_TYPE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">PRIVATE_KEY</span></span>
<span class="line"><span style="color:#6A737D;"># The private key of the deployer account</span></span>
<span class="line"><span style="color:#E1E4E8;">PRIVATE_KEY</span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#6A737D;"># The address of the succinct fee vault contract. Set it to an example address</span></span>
<span class="line"><span style="color:#6A737D;"># if you don&#39;t want to use a vault like: 0x0000000000000000000000000000000000000001</span></span>
<span class="line"><span style="color:#E1E4E8;">SUCCINCT_FEE_VAULT_12345</span><span style="color:#F97583;">=</span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#6A737D;"># The salt to be used for CREATE2 deployments. It&#39;s a 32-byte string in hex format.</span></span>
<span class="line"><span style="color:#6A737D;"># Example: 0x0000000000000000000000000000000000000000000000000000000000000001</span></span>
<span class="line"><span style="color:#24292E;">CREATE2_SALT</span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#6A737D;"># The &#39;owner&#39; of the contracts, recommended to be an EOA</span></span>
<span class="line"><span style="color:#24292E;">GUARDIAN</span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#6A737D;"># The default prover to fulfill requests for Functions that have not opted for a different prover</span></span>
<span class="line"><span style="color:#24292E;">PROVER</span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#6A737D;"># RPC URLs for each chain you want to deploy to</span></span>
<span class="line"><span style="color:#24292E;">RPC_12345</span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#6A737D;"># Etherscan API keys for each chain you want to deploy to</span></span>
<span class="line"><span style="color:#24292E;">ETHERSCAN_API_KEY_12345</span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#6A737D;"># Wallet type is the type of the wallet.</span></span>
<span class="line"><span style="color:#6A737D;"># If you are using a ledger to sign the transaction,</span></span>
<span class="line"><span style="color:#6A737D;"># set \`WALLET_TYPE=LEDGER\` and specify the \`MNEMONIC_INDEX\`</span></span>
<span class="line"><span style="color:#6A737D;"># for which signer you want to use.</span></span>
<span class="line"><span style="color:#6A737D;"># If you are using a private key,</span></span>
<span class="line"><span style="color:#6A737D;"># set \`WALLET_TYPE=PRIVATE_KEY\` and specify the \`PRIVATE_KEY\`.</span></span>
<span class="line"><span style="color:#6A737D;"># In this example, we&#39;re using private key.</span></span>
<span class="line"><span style="color:#24292E;">WALLET_TYPE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">PRIVATE_KEY</span></span>
<span class="line"><span style="color:#6A737D;"># The private key of the deployer account</span></span>
<span class="line"><span style="color:#24292E;">PRIVATE_KEY</span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#6A737D;"># The address of the succinct fee vault contract. Set it to an example address</span></span>
<span class="line"><span style="color:#6A737D;"># if you don&#39;t want to use a vault like: 0x0000000000000000000000000000000000000001</span></span>
<span class="line"><span style="color:#24292E;">SUCCINCT_FEE_VAULT_12345</span><span style="color:#D73A49;">=</span></span></code></pre></div><ul><li><code>PRIVATE_KEY</code>: the private key of the account used to send the transaction.</li><li><code>CREATE2_SALT</code>: the salt used to generate the gateway address. Using the same salt between deployments in different chains will make the gateways be on the same address.</li><li><code>GUARDIAN</code>: the owner of the <code>SuccinctGateway</code> contract. It should be set to an account that will have full access to the gateway.</li><li><code>PROVER</code>: the address of the account used to submit the proofs to the gateway. It is enabled by default for all the registered function verifiers.</li><li><code>RPC_12345</code>: the RPC endpoint for the EVM chain whose chain ID is 12345. If the chain ID is different, make sure to change it in the environment variable name as well.</li><li><code>ETHERSCAN_API_KEY_12345</code>: the Etherscan API key corresponding to the chain whose chain ID is 12345. Similar to <code>RPC_12345</code>, make sure to change the chain ID in the environment variable name if it&#39;s a different chain.</li></ul><p>Then, save the environment to a <code>.env</code> file and run the following:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">./script/deploy.sh</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;SuccinctGateway&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;12345 1234&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">./script/deploy.sh</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;SuccinctGateway&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;12345 1234&quot;</span></span></code></pre></div><p>with <code>12345</code> and <code>1234</code> being chainID that we want to deploy to, given that the corresponding environment variables, as specified above, are setup correctly.</p><p>Now the SuccinctGateway address should be printed on the terminal.</p><h3 id="deploy-the-function-verifiers" tabindex="-1">Deploy the function verifiers <a class="header-anchor" href="#deploy-the-function-verifiers" aria-label="Permalink to &quot;Deploy the function verifiers&quot;">​</a></h3><p>The function verifiers are the onchain circuit verifiers that take PLONK proofs as an input and verify them onchain.</p><p>The function verifiers can be either downloaded from the succinct platform or regenerated.</p><p>To download the function verifiers, along with the circuits binaries, check the list in the <a href="https://hackmd.io/@succinctlabs/HJE7XRrup#Download-Blobstream-X-Plonky2x-Circuits" target="_blank" rel="noreferrer">Succinct documentation</a> and download the binaries and function verifiers corresponding to the circuits you want to verify.</p><p>Alternatively, you can generate them locally as specified in the <a href="#optional-regenerating-the-downloaded-artifacts">regenerating the downloaded artifacts</a> section.</p><p>After getting the <code>FunctionVerifier.sol</code>, either via downloading it or generating it locally, you can choose your favourite way to deploy it.</p><p>A simple way would be to copy the contract in the BlobstreamX repo and deploy it:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> $HOME</span></span>
<span class="line"><span style="color:#B392F0;">git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clone</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">blobstreamx/contracts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">forge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># copy the function verifier contract to the blobstream X contracts</span></span>
<span class="line"><span style="color:#B392F0;">cp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">path_to_function_verifie</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">/FunctionVerifier.sol</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">src</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">forge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">forge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">FunctionVerifier</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rpc-url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">rpc_ur</span><span style="color:#E1E4E8;">l</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--private-key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">private_ke</span><span style="color:#E1E4E8;">y</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--verify</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--verifier</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etherscan</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--etherscan-api-key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">etherscan_api_ke</span><span style="color:#E1E4E8;">y</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;"># ^ will return the address of the function verifier</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> $HOME</span></span>
<span class="line"><span style="color:#6F42C1;">git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clone</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">blobstreamx/contracts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">forge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># copy the function verifier contract to the blobstream X contracts</span></span>
<span class="line"><span style="color:#6F42C1;">cp</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">path_to_function_verifie</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">/FunctionVerifier.sol</span><span style="color:#24292E;"> </span><span style="color:#032F62;">src</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">forge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">forge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">FunctionVerifier</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rpc-url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">rpc_ur</span><span style="color:#24292E;">l</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--private-key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">private_ke</span><span style="color:#24292E;">y</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--verify</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--verifier</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etherscan</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--etherscan-api-key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">etherscan_api_ke</span><span style="color:#24292E;">y</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;"># ^ will return the address of the function verifier</span></span></code></pre></div><h3 id="register-the-function-verifier-in-the-deployed-succinctgateway" tabindex="-1">Register the function verifier in the deployed SuccinctGateway <a class="header-anchor" href="#register-the-function-verifier-in-the-deployed-succinctgateway" aria-label="Permalink to &quot;Register the function verifier in the deployed SuccinctGateway&quot;">​</a></h3><p>After deploying a function verifier for your target circuit, we should register it in a <code>SuccinctGateway</code> contract, either deployed by you in a previous step or pre-existing on the chain, to get a <code>functionID</code> and be able to use it to verify circuits.</p><p>A simple way to do it is to use <code>cast</code> tool from the Foundry toolset:</p><p>First, we will get the expected functionID by calling <code>cast call</code> which simulates the transaction execution and returns the return value:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">cast</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">call</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">succinct_gateway_contract_addres</span><span style="color:#E1E4E8;">s</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;registerFunction(address,address,bytes32)(bytes32)&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rpc-url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">rpc_ur</span><span style="color:#E1E4E8;">l</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">owner_of_the_function_verifie</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">address_of_the_function_verifie</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">32_bytes_of_sal</span><span style="color:#E1E4E8;">t</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--private-key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">private_ke</span><span style="color:#E1E4E8;">y</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cast</span><span style="color:#24292E;"> </span><span style="color:#032F62;">call</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">succinct_gateway_contract_addres</span><span style="color:#24292E;">s</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;registerFunction(address,address,bytes32)(bytes32)&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rpc-url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">rpc_ur</span><span style="color:#24292E;">l</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">owner_of_the_function_verifie</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">address_of_the_function_verifie</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">32_bytes_of_sal</span><span style="color:#24292E;">t</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--private-key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">private_ke</span><span style="color:#24292E;">y</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p>This will return a <code>bytes32</code> which is the function ID.</p><p>Now, we will execute the transaction to register that returned functionID in the gateway, using the same parameters:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">cast</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">send</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">succinct_gateway_contract_addres</span><span style="color:#E1E4E8;">s</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;registerFunction(address,address,bytes32)(bytes32)&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rpc-url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">rpc_ur</span><span style="color:#E1E4E8;">l</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">owner_of_the_function_verifie</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">address_of_the_function_verifie</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">32_bytes_of_sal</span><span style="color:#E1E4E8;">t</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--private-key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">private_ke</span><span style="color:#E1E4E8;">y</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cast</span><span style="color:#24292E;"> </span><span style="color:#032F62;">send</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">succinct_gateway_contract_addres</span><span style="color:#24292E;">s</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;registerFunction(address,address,bytes32)(bytes32)&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rpc-url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">rpc_ur</span><span style="color:#24292E;">l</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">owner_of_the_function_verifie</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">address_of_the_function_verifie</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">32_bytes_of_sal</span><span style="color:#24292E;">t</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--private-key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">private_ke</span><span style="color:#24292E;">y</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p>To verify that the registration was successful, run:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">cast</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">call</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">succinct_gateway_contract_addres</span><span style="color:#E1E4E8;">s</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;verifiers(bytes32)(address)&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rpc-url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">rpc_ur</span><span style="color:#E1E4E8;">l</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">returned_function_I</span><span style="color:#E1E4E8;">D</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cast</span><span style="color:#24292E;"> </span><span style="color:#032F62;">call</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">succinct_gateway_contract_addres</span><span style="color:#24292E;">s</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;verifiers(bytes32)(address)&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rpc-url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">rpc_ur</span><span style="color:#24292E;">l</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">returned_function_I</span><span style="color:#24292E;">D</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p>which will return the address of the function verifier that was deployed in the previous section.</p><blockquote><p><strong><em>NOTE:</em></strong> For BlobstreamX, there are always two function verifiers, corresponding to the two circuits: <code>header_range</code> and <code>next_header</code>. Make sure to register both the function verifiers corresponding to those circuits as we will use those function IDs to deploy the BlobstreamX contract in the next section.</p></blockquote><h4 id="enable-prover-whitelisting" tabindex="-1">Enable prover whitelisting <a class="header-anchor" href="#enable-prover-whitelisting" aria-label="Permalink to &quot;Enable prover whitelisting&quot;">​</a></h4><p>Now that the function verifier&#39;s contract is deployed and registered in the succinct gateway, we can define whitelisting rules for the proof submission.</p><p>by default, the whitelist status is set to <code>Default</code>. This means that only the default verifier, which was setup when <a href="#deploy-a-new-succinctgateway">deploying the SuccinctGateway</a>. And if you want to restrict the list of provers that can submit proofs to your registered function verifier, you can set the whitelisting status of the function verifier and then add a custom prover. Or even allow for permissionless submission.</p><h4 id="set-whitelist-status" tabindex="-1">Set Whitelist Status <a class="header-anchor" href="#set-whitelist-status" aria-label="Permalink to &quot;Set Whitelist Status&quot;">​</a></h4><p>Set the whitelist status of a functionID to:</p><ul><li><code>0</code>: Default status, which only allows the default prover to submit proofs</li><li><code>1</code>: Custom status, which only allows a custom list of provers to submit the proofs. The custom list can be setup by calling the <a href="https://github.com/succinctlabs/succinctx/blob/71f2b3aa395f4e7f824e35f89e75d4a368f963b8/contracts/src/SuccinctGateway.sol#L303C5-L303C76" target="_blank" rel="noreferrer"><code>addCustomProver(bytes32 _functionId, address _prover)</code></a> function.</li><li><code>2</code>: Disabled status, which allow for permissionless proof submission, i.e., any relayer can submit proofs to be verified by that function verifier.</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">cast</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">calldata</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;setWhitelistStatus(bytes32,uint8)&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">YOUR_FUNCTION_I</span><span style="color:#E1E4E8;">D</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">WHITELIST_STATU</span><span style="color:#E1E4E8;">S</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cast</span><span style="color:#24292E;"> </span><span style="color:#032F62;">calldata</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;setWhitelistStatus(bytes32,uint8)&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">YOUR_FUNCTION_I</span><span style="color:#24292E;">D</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">WHITELIST_STATU</span><span style="color:#24292E;">S</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h4 id="add-custom-prover" tabindex="-1">Add Custom Prover <a class="header-anchor" href="#add-custom-prover" aria-label="Permalink to &quot;Add Custom Prover&quot;">​</a></h4><p>Add a custom prover for a specific functionID.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">cast</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">calldata</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;addCustomProver(bytes32,address)&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">FUNCTION_I</span><span style="color:#E1E4E8;">D</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">CUSTOM_PROVER_ADDRES</span><span style="color:#E1E4E8;">S</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cast</span><span style="color:#24292E;"> </span><span style="color:#032F62;">calldata</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;addCustomProver(bytes32,address)&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">FUNCTION_I</span><span style="color:#24292E;">D</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">CUSTOM_PROVER_ADDRES</span><span style="color:#24292E;">S</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h3 id="deploy-the-blobstreamx-contract" tabindex="-1">Deploy the BlobstreamX contract <a class="header-anchor" href="#deploy-the-blobstreamx-contract" aria-label="Permalink to &quot;Deploy the BlobstreamX contract&quot;">​</a></h3><p>To deploy a <code>BlobstreamX</code> contract, you need to have <code>foundry</code> installed. If not, refer to <a href="https://book.getfoundry.sh/getting-started/installation" target="_blank" rel="noreferrer">foundry documentation</a>.</p><p>Then, clone the repository:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> $HOME</span></span>
<span class="line"><span style="color:#B392F0;">git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clone</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">blobstreamx</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> $HOME</span></span>
<span class="line"><span style="color:#6F42C1;">git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clone</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">blobstreamx</span></span></code></pre></div><p>Deploying the BlobstreamX contract requires initializing it with a trusted header.</p><p>In case we want to run a local prover, as is documented in the <a href="#run-a-local-prover">run a local prover</a> section, the trusted header can be any header in the last three weeks of blocks, aka the unbonding period. Using an older header is also possible, but in case of a malicious RPC provider, the malicious validators won&#39;t be slashed.</p><p>Otherwise, we can run a proof replayer that will read the proofs from an existing deployment and submit them into the new one. This is documented under the <a href="#run-a-proof-replayer-from-an-existing-deployment">run a proof replayer from an existing deployment</a> section. In this case, the trusted header should correspond to a height already submitted to the existing deployment, and was the beginning of a batch. These heights can be found via querying the <code>DataCommitmentStored</code> events, or navigating to the <code>events</code> tab in Etherscan for the existing deployment, and choosing a <code>startBlock</code> from a certain event.</p><h4 id="querying-the-trusted-hash" tabindex="-1">Querying the trusted hash <a class="header-anchor" href="#querying-the-trusted-hash" aria-label="Permalink to &quot;Querying the trusted hash&quot;">​</a></h4><p>Given that we have a trusted height, we can query its corresponding trusted hash using:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">TENDERMINT_RPC_URL</span><span style="color:#F97583;">=&lt;</span><span style="color:#9ECBFF;">celestia_rpc_addres</span><span style="color:#E1E4E8;">s</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">cargo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--bin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">genesis</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--block</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">trusted_heigh</span><span style="color:#E1E4E8;">t</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">TENDERMINT_RPC_URL</span><span style="color:#D73A49;">=&lt;</span><span style="color:#032F62;">celestia_rpc_addres</span><span style="color:#24292E;">s</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">cargo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--bin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">genesis</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--block</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">trusted_heigh</span><span style="color:#24292E;">t</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p>Alternatively, the trusted hash can be obtained via querying the <code>&lt;celestia_rpc&gt;/block?height=&lt;trusted_height&gt;</code> and getting the <code>result.block_id.hash</code> field.</p><h4 id="deployment-instructions" tabindex="-1">Deployment instructions <a class="header-anchor" href="#deployment-instructions" aria-label="Permalink to &quot;Deployment instructions&quot;">​</a></h4><p>Once we have the trusted hash, we can deploy the BlobstreamX contract. To do so, create a <code>.env</code> file containing the necessary variables. An example one can be found under <code>contracts/.env.example</code>:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">contracts</span></span>
<span class="line"><span style="color:#B392F0;">cp</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env.example</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env</span></span>
<span class="line"><span style="color:#B392F0;">vim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># and fill the necessary environment variables</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">contracts</span></span>
<span class="line"><span style="color:#6F42C1;">cp</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env.example</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env</span></span>
<span class="line"><span style="color:#6F42C1;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># and fill the necessary environment variables</span></span></code></pre></div><p>The needed environment variables are:</p><ul><li><code>PRIVATE_KEY</code>: the EVM private key to use to deploy the contract.</li><li><code>RPC_URL</code>: the RPC endpoint of the chain where we want to deploy the BlobstreamX contract.</li><li><code>ETHERSCAN_API_KEY</code>: the Etherscan API for the target chain.</li><li><code>CREATE2_SALT</code>: salt for the <code>CREATE2</code> method. Example: <code>0xaa</code>.</li><li><code>GUARDIAN_ADDRESS</code>: the BlobstreamX contract&#39;s owner. It allows it to update the functionIDs of the deployment, freeze the contract, upgrade it, and others.</li><li><code>GATEWAY_ADDRESS</code>: the address of the SuccinctGateway deployment that will update the contract&#39;s state. As stated in the <a href="#deploy-a-new-succinctgateway">section above</a>, the SuccinctGateway is the entrypoint that routes the proof to the function verifier, and if the proof is valid, it updates the BlobstreamX contract.</li><li><code>NEXT_HEADER_FUNCTION_ID</code>: the functionID of the next header circuit verifier. It is obtained after deploying a function verifier, corresponding to the next header circuit, and registering it in the SuccinctGateway. More information in the <a href="#register-the-function-verifier-in-the-deployed-succinctgateway">function verifier registration section</a>.</li><li><code>HEADER_RANGE_FUNCTION_ID</code>: similar to <code>NEXT_HEADER_FUNCTION_ID</code> but for the header range circuit.</li><li><code>GENESIS_HEIGHT</code>: is the height of the trusted header that we queried its trusted hash in the <a href="#querying-the-trusted-hash">querying the trusted hash section</a>. If the value starts with <code>0x</code>, it will be parsed as a hex value. Otherwise, it will be treated as a decimal number.</li><li><code>GENESIS_HEADER</code>: the queried trusted hash in the <a href="#querying-the-trusted-hash">querying the trusted hash section</a>.</li><li><code>DEPLOY</code>: set to true since we&#39;re deploying the contract.</li><li><code>UPGRADE</code>: set to false since we&#39;re not upgrading an existing deployment.</li><li><code>UPDATE_GENESIS_STATE</code>: set to false since we&#39;re not updating the genesis state.</li><li><code>UPDATE_FUNCTION_IDS</code>: set to false since we&#39;re not updating the function IDs.</li><li><code>UPDATE_GATEWAY</code>: set to false since we&#39;re not updating the address of the gateway.</li><li><code>CONTRACT_ADDRESS</code>: set to an empty value since we&#39;re not upgrading the deployment.</li></ul><p>Save the <code>.env</code> file then run:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">forge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">source</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">forge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">script</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">script/Deploy.s.sol</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rpc-url</span><span style="color:#E1E4E8;"> $RPC_URL </span><span style="color:#79B8FF;">--private-key</span><span style="color:#E1E4E8;"> $PRIVATE_KEY </span><span style="color:#79B8FF;">--broadcast</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--verify</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--verifier</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etherscan</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--etherscan-api-key</span><span style="color:#E1E4E8;"> $ETHERSCAN_API_KEY</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">forge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">source</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">forge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">script</span><span style="color:#24292E;"> </span><span style="color:#032F62;">script/Deploy.s.sol</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rpc-url</span><span style="color:#24292E;"> $RPC_URL </span><span style="color:#005CC5;">--private-key</span><span style="color:#24292E;"> $PRIVATE_KEY </span><span style="color:#005CC5;">--broadcast</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--verify</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--verifier</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etherscan</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--etherscan-api-key</span><span style="color:#24292E;"> $ETHERSCAN_API_KEY</span></span></code></pre></div><p>And you should see the address printed in the logs.</p><h3 id="run-a-local-prover" tabindex="-1">Run a local prover <a class="header-anchor" href="#run-a-local-prover" aria-label="Permalink to &quot;Run a local prover&quot;">​</a></h3><p>Now that the BlobstreamX contract is deployed, we can either run a local prover or opt for <a href="#run-a-proof-replayer-from-an-existing-deployment">proofs replaying</a>.</p><p>For running a local prover, make sure to have a beefy machine. It is recommended to run the prover in at least a 32CPU 256GB RAM machine to be able to generate proofs in time for a 1hr proofs submission frequency.</p><p>To run the prover:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> $HOME</span></span>
<span class="line"><span style="color:#6A737D;"># in case you still did not clone the repository:</span></span>
<span class="line"><span style="color:#6A737D;"># git clone https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">blobstreamx</span></span>
<span class="line"><span style="color:#6A737D;"># create the environment for the prover</span></span>
<span class="line"><span style="color:#B392F0;">cp</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env.example</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env</span></span>
<span class="line"><span style="color:#6A737D;"># edit the environment file</span></span>
<span class="line"><span style="color:#B392F0;">vim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> $HOME</span></span>
<span class="line"><span style="color:#6A737D;"># in case you still did not clone the repository:</span></span>
<span class="line"><span style="color:#6A737D;"># git clone https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">blobstreamx</span></span>
<span class="line"><span style="color:#6A737D;"># create the environment for the prover</span></span>
<span class="line"><span style="color:#6F42C1;">cp</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env.example</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env</span></span>
<span class="line"><span style="color:#6A737D;"># edit the environment file</span></span>
<span class="line"><span style="color:#6F42C1;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env</span></span></code></pre></div><p>The following is the required environment for the prover:</p><ul><li><code>PRIVATE_KEY</code>: the EVM private key to use to submit the proofs.</li><li><code>RPC_URL</code>: the RPC endpoint of the chain where the BlobstreamX contract is deployed.</li><li><code>TENDERMINT_RPC_URL</code>: the Celestia chain RPC endpoint. Accepts a comma-separated list of RPC URLs for fail over.</li><li><code>CHAIN_ID</code>: the target EVM chain ID.</li><li><code>CONTRACT_ADDRESS</code>: the target BlobstreamX contract address.</li><li><code>NEXT_HEADER_FUNCTION_ID</code>: the function ID of the next header function registered in the succinct gateway.</li><li><code>HEADER_RANGE_FUNCTION_ID</code>: the function ID of the header range function registered in the succinct gateway.</li><li><code>LOOP_DELAY_MINS</code>: the time to wait before sending the proofs in minutes. For example, for having a proof every 1hr, set it to <code>60</code>.</li><li><code>LOCAL_PROVE_MODE</code>: set to true to enable local proving, which is what these instructions are about.</li><li><code>LOCAL_RELAY_MODE</code>: set to true to enable submitting the proofs onchain, which is what these instructions are about.</li><li><code>GATEWAY_ADDRESS</code>: the address of the succinct gateway contract in the target chain.</li></ul><p>For the circuits binaries, you can either generate them as specified in the <a href="#build-the-circuits-and-function-verifiers">build the circuits section</a>, or download them from the <a href="https://hackmd.io/@succinctlabs/HJE7XRrup#Download-Blobstream-X-Plonky2x-Circuits" target="_blank" rel="noreferrer">Succinct platform</a>. And then set the following environment variables:</p><ul><li><code>PROVE_BINARY_0xFILL_IN_NEXT_HEADER_FUNCTION_ID</code>: the next header circuit binary path. Make sure to also change the <code>0xFILL_IN_NEXT_HEADER_FUNCTION_ID</code> in the environment variable name to the functionID of the corresponding function verifier.</li><li><code>PROVE_BINARY_0xFILL_IN_HEADER_RANGE_FUNCTION_ID</code>: the header range circuit binary path. Make sure to also change the <code>0xFILL_IN_HEADER_RANGE_FUNCTION_ID</code> in the environment variable name to the functionID of the corresponding function verifier.</li></ul><p>Similarly, the verifier build can be generated as specified in the <a href="#regenerate-the-verifier-build">regeneration of the verifier build section</a>, or downloaded from the <a href="https://hackmd.io/@succinctlabs/HJE7XRrup#Download-Verifier-Groth16-Wrapper-Circuit" target="_blank" rel="noreferrer">succinct platform</a>. And then set the following environment variable:</p><ul><li><code>WRAPPER_BINARY</code>: the path the wrapper verifier</li></ul><p>After setting the environment, run:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">source</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.env</span></span>
<span class="line"><span style="color:#B392F0;">cargo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--bin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">blobstreamx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--release</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">source</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.env</span></span>
<span class="line"><span style="color:#6F42C1;">cargo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--bin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">blobstreamx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--release</span></span></code></pre></div><p>And you should see the operator&#39;s logs.</p><h3 id="run-a-proof-replayer-from-an-existing-deployment" tabindex="-1">Run a proof replayer from an existing deployment <a class="header-anchor" href="#run-a-proof-replayer-from-an-existing-deployment" aria-label="Permalink to &quot;Run a proof replayer from an existing deployment&quot;">​</a></h3><p>A cheaper alternative to running the prover locally is to deploy the BlobstreamX contract at a height that is followed by an existing BlobstreamX contract. Then, keep replaying the proofs from the existing deployment to the new one.</p><p>Check the <a href="https://github.com/celestiaorg/blobstream-ops?tab=readme-ov-file#blobstream-proofs-replay" target="_blank" rel="noreferrer">blobstream-ops</a> repository for more documentation.</p><h2 id="optional-regenerating-the-downloaded-artifacts" tabindex="-1">Optional: Regenerating the downloaded artifacts <a class="header-anchor" href="#optional-regenerating-the-downloaded-artifacts" aria-label="Permalink to &quot;Optional: Regenerating the downloaded artifacts&quot;">​</a></h2><p>In case you want to generate <code>verifier-build</code>, which is the template solidity contract used to verify the PLONK proofs onchain, or the circuits build, which are used to generate the proofs, follow this section.</p><p>Otherwise, use the downloaded ones as specified in the previous section.</p><h3 id="regenerate-the-verifier-build" tabindex="-1">Regenerate the <code>verifier-build</code> <a class="header-anchor" href="#regenerate-the-verifier-build" aria-label="Permalink to &quot;Regenerate the \`verifier-build\`&quot;">​</a></h3><p>The <code>verifier-build</code> is the gnark wrapper circuit used by the plonky2x circuits for cheap on-chain verification. It outputs a PLONK proof.</p><p>It can be built using the following instructions:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> $HOME</span></span>
<span class="line"><span style="color:#B392F0;">git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clone</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/succinctlabs/succinctx</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">succinctx</span></span>
<span class="line"><span style="color:#B392F0;">cargo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">test</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">test_wrapper</span></span>
<span class="line"><span style="color:#6A737D;"># ^ This should generate a data folder under plonky2x/verifier/data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Compile circuit</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">plonky2x/verifier</span></span>
<span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">verifier-build</span></span>
<span class="line"><span style="color:#B392F0;">go</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-compile</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-data</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">verifier-build</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-circuit</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">data/dummy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Compile executable</span></span>
<span class="line"><span style="color:#E1E4E8;">CGO_ENABLED</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">go</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">build</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-o</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">verifier-build/verifier</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-ldflags</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;-s -w&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">ls</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">verifier-build/</span></span>
<span class="line"><span style="color:#6A737D;"># ^ should have: pk.bin  r1cs.bin  verifier  Verifier.sol  vk.bin</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> $HOME</span></span>
<span class="line"><span style="color:#6F42C1;">git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clone</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/succinctlabs/succinctx</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">succinctx</span></span>
<span class="line"><span style="color:#6F42C1;">cargo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">test</span><span style="color:#24292E;"> </span><span style="color:#032F62;">test_wrapper</span></span>
<span class="line"><span style="color:#6A737D;"># ^ This should generate a data folder under plonky2x/verifier/data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Compile circuit</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">plonky2x/verifier</span></span>
<span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#032F62;">verifier-build</span></span>
<span class="line"><span style="color:#6F42C1;">go</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-compile</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-data</span><span style="color:#24292E;"> </span><span style="color:#032F62;">verifier-build</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-circuit</span><span style="color:#24292E;"> </span><span style="color:#032F62;">data/dummy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Compile executable</span></span>
<span class="line"><span style="color:#24292E;">CGO_ENABLED</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">go</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-o</span><span style="color:#24292E;"> </span><span style="color:#032F62;">verifier-build/verifier</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-ldflags</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;-s -w&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">ls</span><span style="color:#24292E;"> </span><span style="color:#032F62;">verifier-build/</span></span>
<span class="line"><span style="color:#6A737D;"># ^ should have: pk.bin  r1cs.bin  verifier  Verifier.sol  vk.bin</span></span></code></pre></div><p>This should generate the <code>Verifier.sol</code> contract which is a template contract used to generate the final function verifiers based on the plonky2x circuits.</p><p>In the generated contract, only the circuit digest is specific to each circuit; the rest of the logic is universal. This is why a random circuit was used to create the template, indicated by the flag <code>-circuit data/dummy</code>. When we build a specific circuit, the <code>Verifier.sol</code> contract is fed to the circuit builder, which then replaces the circuit digest with the one corresponding to the actual circuit being built.</p><p>Also, you will see the <code>verifier</code> binary which is the PLONK wrapper that takes a plonky2x proof and wraps it into a PLONK proof.</p><p>During the build, the CRS string gets downloaded:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:35:00</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript04.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript04.dat</span></span>
<span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:35:05</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript05.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript05.dat</span></span>
<span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:35:11</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript06.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript06.dat</span></span>
<span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:35:41</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript11.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript11.dat</span></span>
<span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:35:47</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript12.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript12.dat</span></span>
<span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:35:53</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript13.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript13.dat</span></span>
<span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:35:58</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript14.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript14.dat</span></span>
<span class="line"><span style="color:#B392F0;">2024/04/15</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">19</span><span style="color:#9ECBFF;">:36:03</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript15.dat</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">196</span><span style="color:#9ECBFF;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript15.dat</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:35:00</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript04.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript04.dat</span></span>
<span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:35:05</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript05.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript05.dat</span></span>
<span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:35:11</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript06.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript06.dat</span></span>
<span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:35:41</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript11.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript11.dat</span></span>
<span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:35:47</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript12.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript12.dat</span></span>
<span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:35:53</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript13.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript13.dat</span></span>
<span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:35:58</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript14.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript14.dat</span></span>
<span class="line"><span style="color:#6F42C1;">2024/04/15</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#032F62;">:36:03</span><span style="color:#24292E;"> </span><span style="color:#032F62;">download</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/196_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript15.dat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">196</span><span style="color:#032F62;">_0x9c3f372a2aacc0d7272f56a4664311b7647b0031/transcript15.dat</span></span></code></pre></div><p>This randomness is taken from the Aztec trusted <a href="https://medium.com/aztec-protocol/aztec-announcing-our-ignition-ceremony-757850264cfe" target="_blank" rel="noreferrer">setup</a>.</p><blockquote><p><strong><em>NOTE:</em></strong> In a scaleway instance of 64CPU and 504G RAM, the build takes ~20 minutes to complete. Make sure to run it on a beefy machine.</p></blockquote><h3 id="build-the-circuits-and-function-verifiers" tabindex="-1">Build the circuits and function verifiers <a class="header-anchor" href="#build-the-circuits-and-function-verifiers" aria-label="Permalink to &quot;Build the circuits and function verifiers&quot;">​</a></h3><p>To build the circuits:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> $HOME</span></span>
<span class="line"><span style="color:#B392F0;">git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clone</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">blobstreamx</span></span>
<span class="line"><span style="color:#6A737D;"># if a specific version is needed: git checkout &lt;commit&gt;</span></span>
<span class="line"><span style="color:#6A737D;"># this assumes the verifier-build was generated in the previous section.</span></span>
<span class="line"><span style="color:#6A737D;"># if not, it can be downloaded as specified in the first section.</span></span>
<span class="line"><span style="color:#B392F0;">cp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">../succinctx/plonky2x/verifier/verifier-build</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.</span></span>
<span class="line"><span style="color:#6A737D;"># ^ This copies the verifier build to the blobstreamx folder</span></span>
<span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">build</span><span style="color:#E1E4E8;"> &amp;&amp; RUST_LOG</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">debug</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">cargo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--bin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">header_range_1024</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--release</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">build</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--wrapper-path</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">verifier-build/</span><span style="color:#E1E4E8;"> &amp;&amp; </span><span style="color:#B392F0;">mv</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./target/release/header_range_1024</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./build/header_range_1024</span></span>
<span class="line"><span style="color:#B392F0;">ls</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">build</span></span>
<span class="line"><span style="color:#6A737D;"># ^ should return something like: 0x007d0b2a2e2b013612e8.circuit  0x9039e58b2089e5f9abbb.circuit  0xce1636cfaf2bd5497c11.circuit  FunctionVerifier.sol  main.circuit 0x8e1ede4ce0865b41d714.circuit  0xa2140c9bde000dc5e21e.circuit  0xf6759ff933786ddacb92.circuit  header_range_1024</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> $HOME</span></span>
<span class="line"><span style="color:#6F42C1;">git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clone</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/succinctlabs/blobstreamx</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">blobstreamx</span></span>
<span class="line"><span style="color:#6A737D;"># if a specific version is needed: git checkout &lt;commit&gt;</span></span>
<span class="line"><span style="color:#6A737D;"># this assumes the verifier-build was generated in the previous section.</span></span>
<span class="line"><span style="color:#6A737D;"># if not, it can be downloaded as specified in the first section.</span></span>
<span class="line"><span style="color:#6F42C1;">cp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-r</span><span style="color:#24292E;"> </span><span style="color:#032F62;">../succinctx/plonky2x/verifier/verifier-build</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.</span></span>
<span class="line"><span style="color:#6A737D;"># ^ This copies the verifier build to the blobstreamx folder</span></span>
<span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span><span style="color:#24292E;"> &amp;&amp; RUST_LOG</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">debug</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">cargo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--bin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">header_range_1024</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--release</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--wrapper-path</span><span style="color:#24292E;"> </span><span style="color:#032F62;">verifier-build/</span><span style="color:#24292E;"> &amp;&amp; </span><span style="color:#6F42C1;">mv</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./target/release/header_range_1024</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./build/header_range_1024</span></span>
<span class="line"><span style="color:#6F42C1;">ls</span><span style="color:#24292E;"> </span><span style="color:#032F62;">build</span></span>
<span class="line"><span style="color:#6A737D;"># ^ should return something like: 0x007d0b2a2e2b013612e8.circuit  0x9039e58b2089e5f9abbb.circuit  0xce1636cfaf2bd5497c11.circuit  FunctionVerifier.sol  main.circuit 0x8e1ede4ce0865b41d714.circuit  0xa2140c9bde000dc5e21e.circuit  0xf6759ff933786ddacb92.circuit  header_range_1024</span></span></code></pre></div><p>The <code>header_range_1024</code> is a specific circuit. Other circuit names can be used there. The current circuits that we have for BlobstreamX:</p><ul><li><code>header_range_1024</code>: skip function circuit for batches that are &lt;= 1024 block.</li><li><code>header_range_2048</code>: skip function circuit for batches that are &lt;= 2048 block.</li><li><code>next_header</code>: step function circuit.</li></ul><p>All the deployments currently rely on two circuits: a header range circuit, either the 1024 or the 2048, depending on the frequency of the batches; The 1024 is mainly for batches that are at a ~1hr frequency and the 2048 for batches that are at a ~3-4hr frequency; and a next header circuit. So, if you&#39;re re-building the circuits, make sure to build the correct two circuits for your target deployment.</p><p>Now, if you check the <code>build</code> folder, you will find a file called <code>FunctionVerifier.sol</code>, which is the function verifier contract for your circuit that you can deploy on-chain.</p><p>Also, you will find the <code>header_range_1024</code> under <code>build</code> folder which is the binary used to generate the proofs. It is mainly used by the operator to generate the plonky2x proofs that will be PLONK wrapped later using the generated <code>verifier-build</code>.</p><p>At this level, you can deploy the <code>FunctionVerifier.sol</code> onchain, then register it in the SuccinctGateway, then use the generated <code>header_range_1024</code> circuit and the <code>verifier</code> to generate the proofs and submit them onchain. These steps are detailed in the previous section.</p><blockquote><p><strong><em>NOTE:</em></strong> In a scaleway instance of 64CPU and 504G RAM, the build takes ~10 minutes to complete. Make sure to run it on a beefy machine.</p></blockquote>`,113)])])}const h=a(l,[["render",t]]);export{E as __pageData,h as default};
